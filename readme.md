# *RevelioPlots*

## 1. Overview
RevelioPlots is an interactive web application designed for the quality assessment of protein structure models. By parsing Crystallographic Information Files (`.cif or .mmcif`), the app provides a suite of intuitive visualizations centered around the per-residue Local Distance Difference Test (pLDDT) score, a key metric for model confidence, particularly in structures generated by tools like AlphaFold.

The application allows researchers, students, and scientists to quickly analyze and compare the reliability of protein models, identify potentially disordered or poorly modeled regions, and assess the stereochemical quality of the polypeptide backbone.

>*Please confirm if your `.cif` files contain pLDDT scores. If they are B-Factor values, the application will interpret them as pLDDT scores.*

## 2. Features
RevelioPlots offers a range of features for in-depth structural analysis:

### pLDDT Score Analysis

**Statistical Summary:** Automatically calculates and displays the mean, median, and standard deviation of pLDDT scores for each structure.

**Interactive Distribution Plot:** A box plot shows the distribution of pLDDT scores across all residues, with each point representing a residue and being interactive on hover.

#### Confidence-Colored Sequence View

**Full Sequence Visualization:** Displays the entire amino acid sequence of the protein.

**pLDDT-Based Coloring:** Each residue is colored according to its pLDDT score using the standard AlphaFold color scheme, providing an immediate visual map of model confidence.

- <span style="color:#0053D6">Blue (>90)</span> - High confidence
- <span style="color:#65CBF3">Cyan (70-90)</span> - Confident
- <span style="color:#FFDB13">Yellow (50-70)</span> - Low confidence
- <span style="color:#FF7D45">Red (&lt;50)</span> - Very low confidence (likely disordered)

**Positional Scale:** A numeric scale appears above the sequence, marking every 10<sup>th</sup> residue to help in locating specific regions.

**Interactive Tooltips:** Hovering over any amino acid reveals its residue number and exact pLDDT score.

#### Interactive Ramachandran Plot

**Backbone Conformation Analysis:** Plots the Phi (
Phi) versus Psi (
Psi) dihedral angles for each residue.

**Confidence Correlation:** Points on the plot are colored by their pLDDT value, allowing for a direct visual correlation between local backbone conformation and model confidence.

**Allowed Regions:** The plot is shaded to show the sterically allowed regions for common secondary structures (e.g., alpha-helices and beta-sheets), making it easy to spot outliers.

**Detailed Hover Info:** Tooltips on each point provide residue identity, number, pLDDT score, and precise Phi/Psi angles.
Analysis Modes

**Single Structure:** Perform a deep dive into a single protein model.
Multi-Structure: Upload multiple models to directly compare their statistics and plots side-by-side.

## 3. How to Use

The application is organized into two main tabs for different analysis modes.

### Single Structure Analysis Tab
This tab is for the detailed analysis of one protein model.

**Choose Source:** Select whether to *"Upload a file"* from your computer or *"Use an example"* from the server.

**Provide File:**
If uploading, drag-and-drop or browse to select your `.cif` or `.mmcif` file. If using an example, choose a file from the dropdown menu.

**View Analysis:** The app automatically processes the file and displays three analysis sections:
- pLDDT Statistics and Distribution Plot.
    - Confidence-Colored Sequence.
- Ramachandran Plot.

### Multi-Structure Comparison Tab
This tab is for comparing two or more protein models.

**Choose Source:** As with the single analysis, choose to upload files or use examples.

**Provide Files:** Select all the `.cif` or `.mmcif` files you wish to compare.

**View Comparative Analysis:** The app first displays plots that compare all structures together:
- A table summarizing the pLDDT statistics for each model.
- A comparative box plot showing the pLDDT distributions for all models on a single chart.

**View Detailed Analysis:** Below the comparative plots, a *"Per-Structure Analysis"* section contains collapsible panes for each file. Click on a pane to view the detailed Confidence-Colored Sequence and Ramachandran Plot for that specific structure.

## 4. Installation and Setup

To run RevelioPlots on your local machine, you will need Python 3.8+ and the `pip` package manager.

### I. Save the Code
Save the final application code as a Python file named `RevelioPlots.py.`

### II. Set Up a Virtual Environment (Recommended)
It is good practice to create a separate environment for the app's dependencies.

```bash
python -m venv venv
source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
```
### III. Install Libraries
Install all the required Python libraries using pip:

```Bash
pip install streamlit pandas numpy biopython plotly
```
### IV. Run the App
Navigate to the directory where you saved RevelioPlots.py in your terminal and run the following command:

```Bash
streamlit run RevelioPlots.py
```
The application should automatically open in a new tab in your web browser.

### V. Interpreting the Visualizations

**pLDDT Plot:** A high mean/median pLDDT (> 85-90) generally indicates a high-quality model. A large spread (standard deviation) or a long tail in the box plot suggests the model has regions of significantly lower confidence.

**Colored Sequence:** This is the quickest way to identify potentially problematic regions. Long stretches of yellow or red may correspond to flexible loops, disordered regions, or parts of the model that could not be confidently predicted.

**Ramachandran Plot:** This plot evaluates the stereochemical quality of the protein's backbone.
Well-behaved structures: Most points (residues) will fall within the shaded, energetically favorable regions.

**Outliers:** Points in the white areas are "disallowed" and may indicate structural strain, incorrect modeling, or high flexibility.

**Correlation with pLDDT:** The most powerful insight comes from correlating outliers with their pLDDT score. A red or yellow point in a disallowed region strongly suggests that this part of the model is unreliable. Glycine and proline residues are exceptions and are expected to fall outside the main regions.